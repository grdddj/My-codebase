<!DOCTYPE html>
<html class="language_chosen" lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width"> <!-- setting the view on multiple devices -->
    <meta name="description" content="Web page about blockchain technology">
    <meta name="keywords" content="blockchain, ethereum">
    <meta name="author" content="Jiří Musil">
    <title>Musil Blockchain | Applications</title>
    <link rel="stylesheet" href="../css/style3.css"> <!-- connecting it with a CSS stylesheet -->

    <script type="text/javascript" src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
    <script src="script.js"></script>
    <script type="text/javascript">
    /* Autogenerated - do not fiddle */
    if(typeof(Contracts)==="undefined") var Contracts={};
    (function(module, Contracts) {
    var data={
        address: "0x1d397e7b8baef27063b5448388088d059fcd8853",
        network: "rinkeby",
        endpoint: "https://rinkeby.infura.io/",
        abi: [{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"BCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessCCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessBCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessCCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"names","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"getAccessBCoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"getAccessACoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessBCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"registered","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"CCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getAllAccessRights","outputs":[{"name":"","type":"bool"},{"name":"","type":"bool"},{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"getAccessCCoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"}],"name":"register","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"ACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"adresa","type":"address"},{"indexed":false,"name":"name","type":"string"}],"name":"Registration","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"coin","type":"string"}],"name":"AccesPurchased","type":"event"}]
    };
    Contracts["Tokeny"]=data;
    module.exports=data;
    })((typeof(module)==="undefined"?{}:module), Contracts);

    (function (Contract) {
    var web3_instance;
    var instance;
    var accounts;

    function init(cb) {
         $("#noMetamask").show();
        web3_instance = new Web3(
            (window.web3 && window.web3.currentProvider) ||
            new Web3.providers.HttpProvider(Contract.endpoint));

        accounts = web3.eth.accounts;

        var contract_interface = web3_instance.eth.contract(Contract.abi);
        instance = contract_interface.at(Contract.address);
        cb();
    }


    function waitForReceipt(txHash, cb) {
        web3_instance.eth.getTransactionReceipt(txHash, function (error, receipt) {
            if (error) {
                alert(error);
            }
            else if (receipt !== null) {
                cb(receipt);
            }
            else {
                window.setTimeout(function () {
                    waitForReceipt(txHash, cb)
                }, 5000);
            }
        });
    }

    function getAddress() {
        var address;
        address = accounts[0].toString();
        if (address.length > 0) {
            $("#address").html(address);
            $("#noMetamask").hide();
        }
        else {
            $("#address").html("Please login into metamask");
        }
    }

      function buyA() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessACoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000, gasPrice: 5000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

      function buyB() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessBCoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000, gasPrice: 5000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

      function buyC() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessCCoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000, gasPrice: 5000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

    function updateInfo() {

            var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

           instance.getAllAccessRights(accounts[0], function (error, results) {
            if (error) {
                alert(error);
            }
            else {
                     $("#myTokens").html("");
                     $("#myArticles").html("");

                accessA = results[0];
                accessB = results[1];
                accessC = results[2];

                if(accessA) {
                     $("#myTokens").append("<p>ACoin</p>");
                     $("#myArticles").append("<p><a href='clanek1.html'>Článek A</a></p>");
                     $("#btnA").html("Zakoupeno, děkujeme!");
                }

                if(accessB) {
                    $("#myTokens").append("<p>BCoin</p>");
                      $("#myArticles").append("<p><a href='clanek2.html'>Článek B</a></p>");
                       $("#btnB").html("Zakoupeno, děkujeme!");
                }

                if(accessC) {
                    $("#myTokens").append("<p>CCoin</p>");
                      $("#myArticles").append("<p><a href='clanek3.html'>Článek C</a></p>");
                       $("#btnC").html("Zakoupeno, děkujeme!");
                }

                loaderTX.hide();
                content.show();
                getName(accounts[0]);

            }
        });
    }



    $(document).ready(function () {
        init(function () {

            getAddress();
            updateInfo();


          $("#buyA").click(function () {
            buyA();
        });

         $("#buyB").click(function () {
            buyB();
        });

         $("#buyC").click(function () {
            buyC();
        });

        });
    });
    })(Contracts['Tokeny']);
    </script>

    <style type="text/css">

table {
font-family: arial, sans-serif;
border-collapse: collapse;
width: 100%;
}

td, th {
border: 1px solid #dddddd;
text-align: left;
padding: 8px;
}
</style>


  </head>
  <body>

    <header>
      <div class="container">
        <div id="branding">
          <h1><span class="highlight">Musil Blockchain</span></h1>
        </div>
        <nav>
          <ul>
            <li class="en "><a href="../indexEng.html">Home</a></li>
            <li class="en"><a href="../aboutEng.html">About</a></li>
            <li class="en"><a href="../sourcesEng.html">Sources</a></li>
            <li class="en"><a href="../servicesEng.html">Services</a></li>
              <li class="en"><a href="../articlesEng.html">Articles</a></li>
            <li class="en current"><a href="../applicationsEng.html">Applications</a></li>
            <li class="en language"><a href="appContent.html"><img src="../img/cz.png" alt="Přejít do češtiny" width="58" height="42"></a> </li>



          </ul>
        </nav>
      </div>
    </header>


    <section id="main">
      <div class="container">
          <article id="main-col">
            <h1 class="en page-title">Blockchain content accessing</h1>

            <p><b>Idea</b>: To make it easier and more free to access articles or other content in paid sections. Without any registration, quickly and effortlessly. </p>
            <p><b>Functioning</b>: After clicking the "Buy" button transaction is generated, and after user signs it he will receive a cryptographic token allowing him to access the content. Immediately after that the link to content will appear. </p>
            <p><b>Advantages</b>: For the user there is no need for registration or other private data sharing, for example with a credit card payment. The provider will get the money immediately. </p>
            <p><b>Disadvantages</b>: User's browser must communicate with blockchain. For getting content the transaction needs to be validated on the blockchain, which can take some time (10-15 seconds).  </p>
            <p>------------------------------------------------------------------------------------------------------------------------------</p>

            <div  style="text-align:center; padding: 10px;">



            <div id="noMetamask" style="display: none;">
                <h2 style="color:red">For the content unlocking you need to be connected to Ethereum network, specifically Rinkeby Test Network. Browser extension Metamask is recommended.</h2>
              </div>

                        <div id="loaderTX" style="display: none;">
                  <p class="text-center">Please wait, your changes are updating...</p>
                  <p>In the meantime you can play for example <a href='../pexeso.html' target="_blank">pexeso</a></p>
                </div>


                  <div id="registered">

                  <br>
                <h2 >My ETH address: <span id="address"></span></h2>

                <h2>My owned tokens: <span id="myTokens"></span></h2>
                <h2>My unlocked articles: <span id="myArticles"></span></h2>



                  <br>
                    <h3>List of articles with needed tokens</h3>


                            <table id="myTable">
                            <thead>
                            <tr>

                                <th>Article</th>
                                <th>Token</th>
                                <th>Price</th>
                                <th>Buy</th>
                            </tr>

                            <tr>
                                <td>Article A</td>
                                <td>ACoin</td>
                                <td>0.001 ETH</td>
                                <td><span id="btnA"><button id="buyA">Buy A!</button></span></td>
                            </tr>

                            <tr>
                                <td>Article B</td>
                                <td>BCoin</td>
                                <td>0.001 ETH</td>
                                <td><span id="btnB"><button id="buyB">Buy B!</button></span></td>
                            </tr>

                            <tr>
                                <td>Article C</td>
                                <td>CCoin</td>
                                <td>0.001 ETH</td>
                                <td><span id="btnC"><button id="buyC">Buy C!</button></span></td>
                            </tr>


                            </thead>

                            </table>

</div>
</div>

          </article>
          <aside id="sidebar">
            <div class="dark">

              <h3 class="cz">Specific blockchain use-cases</h3>
                <div class="">

                </div>


                  <h3 class="cz orange"><a href="./appContentEng.html" style="color:#ffffff">Blockchain content accessing</a></h3>

                  <h3 class="cz orange"><a href="./appCrowdfundingEng.html" style="color:#e8491d">Blockchain crowdfunding</a></h3>

                  <h3 class="cz orange"><a href="./appAuctionEng.html" style="color:#e8491d">Blockchain auction</a></h3>

                  <h3 class="cz orange"><a href="./appRouletteEng.html" style="color:#e8491d">Blockchain roulette</a></h3>

                  <h3 class="cz orange"><a href="./appPocketEng.html" style="color:#e8491d">Blockchain pocket-money</a></h3>

                  <h3 class="cz orange"><a href="./appTipEng.html" style="color:#e8491d">Blockchain tipping</a></h3>

                  <h3 class="cz orange"><a href="./appReceivingCCEng.html" style="color:#e8491d">Blockchain payment accepting</a></h3>

                  <h3 class="cz orange"><a href="./appSwapEng.html" style="color:#e8491d">Blockchain exchange</a></h3>

                  <h3 class="cz orange"><a href="./appDigitalSignaturesEng.html" style="color:#e8491d">Blockchain autentication and authorization</a></h3>

                  <h3 class="cz orange"><a href="./appMultisignatureEng.html" style="color:#e8491d">Blockchain contracts</a></h3>

                  <h3 class="cz orange"><a href="./appElectionsEng.html" style="color:#e8491d">Blockchain elections</a></h3>

                </div>

            </div>
          </aside>
        </div>
    </section>

    <footer>
      <p>Jiří Musil, Copyright &copy; 2018</p>
    </footer>


  </body>
</html>
