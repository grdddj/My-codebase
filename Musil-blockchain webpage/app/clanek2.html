<!DOCTYPE html>
<html class="language_chosen" lang="cz" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width"> <!-- setting the view on multiple devices -->
    <meta name="description" content="Web page about blockchain technology">
    <meta name="keywords" content="blockchain, ethereum">
    <meta name="author" content="Jiří Musil">
    <title>Musil Blockchain | Aplikace</title>
    <link rel="stylesheet" href="../css/style3.css"> <!-- connecting it with a CSS stylesheet -->

    <script type="text/javascript" src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
    <script src="script.js"></script>
    <script type="text/javascript">
    /* Autogenerated - do not fiddle */
    if(typeof(Contracts)==="undefined") var Contracts={};
    (function(module, Contracts) {
    var data={
        address: "0xfb606e0e829b23b00031c8e1ab806b00bc6b2e2c",
        network: "rinkeby",
        endpoint: "https://rinkeby.infura.io/",
        abi: [{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"BCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessCCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_user","type":"address"}],"name":"transferAccessBCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessCCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"names","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"getAccessBCoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[],"name":"getAccessACoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"checkAccessBCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"registered","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"CCoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_user","type":"address"}],"name":"getAllAccessRights","outputs":[{"name":"","type":"bool"},{"name":"","type":"bool"},{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"getAccessCCoin","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":false,"inputs":[{"name":"_name","type":"string"}],"name":"register","outputs":[],"payable":true,"stateMutability":"payable","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"ACoin","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"adresa","type":"address"},{"indexed":false,"name":"name","type":"string"}],"name":"Registration","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"},{"indexed":false,"name":"coin","type":"string"}],"name":"AccesPurchased","type":"event"}]
    };
    Contracts["Tokeny"]=data;
    module.exports=data;
    })((typeof(module)==="undefined"?{}:module), Contracts);

    (function (Contract) {
    var web3_instance;
    var instance;
    var accounts;




    function init(cb) {
         $("#noMetamask").show();
        web3_instance = new Web3(
            (window.web3 && window.web3.currentProvider) ||
            new Web3.providers.HttpProvider(Contract.endpoint));

        accounts = web3.eth.accounts;

        var contract_interface = web3_instance.eth.contract(Contract.abi);
        instance = contract_interface.at(Contract.address);
        cb();
    }


    function waitForReceipt(txHash, cb) {
        web3_instance.eth.getTransactionReceipt(txHash, function (error, receipt) {
            if (error) {
                alert(error);
            }
            else if (receipt !== null) {
                cb(receipt);
            }
            else {
                window.setTimeout(function () {
                    waitForReceipt(txHash, cb)
                }, 5000);
            }
        });
    }

    function getAddress() {
        var address;
        address = accounts[0].toString();
        if (address.length > 0) {
            $("#address").html(address);
        }
        else {
            $("#address").html("Please login into metamask");
        }
    }

      function buyA() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessACoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

      function buyB() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessBCoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

      function buyC() {
          var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

            instance.getAccessCCoin.sendTransaction({ from: accounts[0], gas: 300000, value: 1000000000000000 }, function (error, txHash) {
            if (error) {
                alert("Transaction didn't get through - try again!");
                loaderTX.hide();
                content.show();
            }
            else {
                waitForReceipt(txHash, function (receipt) {
                    if (receipt.status === "0x1") {
                      updateInfo();
                    }
                    else {
                        alert("Receive status failed");
                    }
                });
            }
        });
    }

    function updateInfo() {

            var loaderTX = $("#loaderTX");
            var content = $("#registered");

            loaderTX.show();
            content.hide();

           instance.getAllAccessRights(accounts[0], function (error, results) {
            if (error) {
                alert(error);
            }
            else {
                     $("#myTokens").html("");
                     $("#myArticles").html("");

                accessA = results[0];
                accessB = results[1];
                accessC = results[2];

                if(accessA) {
                     $("#myTokens").append("<p>ACoin</p>");
                     $("#myArticles").append("<p><a href='clanek1.html'>Článek A</a></p>");
                     $("#btnA").html("Zakoupeno, děkujeme!");
                }

                if(accessB) {
                    $("#myTokens").append("<p>BCoin</p>");
                      $("#myArticles").append("<p><a href='clanek2.html'>Článek B</a></p>");
                       $("#btnB").html("Zakoupeno, děkujeme!");
                }

                if(accessC) {
                    $("#myTokens").append("<p>CCoin</p>");
                      $("#myArticles").append("<p><a href='clanek3.html'>Článek C</a></p>");
                       $("#btnC").html("Zakoupeno, děkujeme!");
                }

                loaderTX.hide();
                content.show();
                getName(accounts[0]);

            }
        });
    }



    $(document).ready(function () {
        init(function () {

            getAddress();






          $("#buyA").click(function () {
            buyA();
        });

         $("#buyB").click(function () {
            buyB();
        });

         $("#buyC").click(function () {
            buyC();
        });

        });
    });
    })(Contracts['Tokeny']);
    </script>

    <style type="text/css">

table {
font-family: arial, sans-serif;
border-collapse: collapse;
width: 100%;
}

td, th {
border: 1px solid #dddddd;
text-align: left;
padding: 8px;
}
</style>


  </head>
  <body>

    <header>
      <div class="container">
        <div id="branding">
          <h1><span class="highlight">Musil Blockchain</span></h1>
        </div>
        <nav>
          <ul>

            <li class="cz"><a href="../index.html">Domů</a></li>
            <li class="cz"><a href="../about.html">O mně</a></li>
            <li class="cz "><a href="../sources.html">Zdroje</a></li>
            <li class="cz"><a href="../services.html">Služby</a></li>
            <li class="cz current"><a href="../applications.html">Aplikace</a></li>
            <li class="cz language"><a href="appContentEng.html"><img src="../img/gb.png" alt="Switch into english" width="58" height="42"></a> </li>
          </ul>
        </nav>
      </div>
    </header>

    <section id="main">
      <div class="container">
          <article id="main-col">
            <h1 class="cz page-title">Článek 2</h1>

            <p>Byl jednou druhej článek...</p>

          </article>

                    <aside id="sidebar">
                      <div class="dark">

                        <h3 class="cz">Příklady konkrétních aplikací</h3>
                          <div class="">

                          </div>

                            <h3 class="cz orange"><a href="./appContent.html" style="color:#ffffff">Blockchainové zpřístupňování obsahu</a></h3>

                            <h3 class="cz orange"><a href="./appCrowdfunding.html" style="color:#e8491d">Blockchainové financování projektů</a></h3>

                            <h3 class="cz orange"><a href="./appAuction.html" style="color:#e8491d">Blockchainová aukce</a></h3>

                            <h3 class="cz orange"><a href="./appRoulette.html" style="color:#e8491d">Blockchainová ruleta</a></h3>

                            <h3 class="cz orange"><a href="./appPocket.html" style="color:#e8491d">Blockchainové kapesné</a></h3>

                            <h3 class="cz orange"><a href="./appTip.html" style="color:#e8491d">Blockchainové spropitné</a></h3>

                            <h3 class="cz orange"><a href="./appReceivingCC.html" style="color:#e8491d">Blockchainové přijímání plateb</a></h3>

                            <h3 class="cz orange"><a href="./appSwap.html" style="color:#e8491d">Blockchainová směnárna</a></h3>

                            <h3 class="cz orange"><a href="./appDigitalSignatures.html" style="color:#e8491d">Blockchainová autentikace a autorizace</a></h3>

                            <h3 class="cz orange"><a href="./appMultisignature.html" style="color:#e8491d">Blockchainové smlouvy</a></h3>

                            <h3 class="cz orange"><a href="./appElections.html" style="color:#e8491d">Blockchainové volby</a></h3>

                          </div>

                      </div>
                    </aside>
                </div>


    </section>

    <footer>
      <p>Jiří Musil, Copyright &copy; 2018</p>
    </footer>


  </body>
</html>
